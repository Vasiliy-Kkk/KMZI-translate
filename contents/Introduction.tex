\introduction
Многие симметричные примитивы полагаются на S-блоки как на единственный источник нелинейности, включая AES \cite{AES01}. Такие объекты представляют собой небольшие функции, отображающие \(\mathbb{F}_2^m\) в \(\mathbb{F}_2^n\), которые часто задаются через таблицы поиска. Их выбор имеет решающее значение, поскольку безопасность и эффективность примитива сильно зависят от их свойств. Например, низкая разностная однородность \cite{Nyb94} подразумевает более высокую устойчивость к разностным атакам \cite{BS91a, BS91b}. С другой стороны, существование простого разложения сильно помогает при эффективной поразрядной (bitsliced) или аппаратной реализации \cite{LW14, CDL16}. Таким образом, от разработчиков алгоритмов ожидается, что они предоставят детальное объяснение своего выбора S-блока. Каждый шифр, опубликованный на конференции по криптографии или безопасности, содержит такие объяснения.

Существует два известных S-блока, для которых данная информация не была предоставлена. Первый — это так называемая «F-таблица» Skipjack \cite{US98}, легковесного блочного шифра, разработанного Американским агентством национальной безопасности (АНБ). Второй — это \(\pi\), 8-битная перестановка, использованная в российской стандартной хеш-функции (позднее названной Стрибог \cite{Fed12}) и блочном шифре (позже названном Кузнечик \cite{Fed15}), а также в первой версии кандидата CAESAR — STRIBOBr1 \cite{Saa14} (которая позже изменила свои компоненты на компоненты из Whirlpool \cite{SB15}). Хотя Стрибог и Кузнечик были впервые опубликованы как национальные стандарты в России (ГОСТ), они с тех пор были включены в другие стандарты. Например, оба были включены IETF как RFC 6986 \cite{DD13} и RFC 7801 \cite{Dol16} соответственно. ISO/IEC также в процессе добавления Кузнечика в список стандартных блочных шифров, а именно стандарт 18033-3.

Было обнаружено, что S-блоки могут быть потенциальными средствами для вставки бэкдора в симметричный алгоритм. В 1997 году Раймен и Прениль предложили стратегию генерации S-блока, которая гарантировала существование линейного перехода с высокой вероятностью \cite{RP97}. Идея заключалась в том, что только разработчик будет знать об этой линейной аппроксимации, но это утверждение позже было опровергнуто \cite{WBDY98}. Позже Патерсон разработал вариант DES с бэкдором и измененными S-блоками \cite{Pat99}. Его общий подход был недавно усовершенствован Bannier и др. \cite{BBF16} для построения блочного шифра, который сохраняет разбиение множество открытых текстов независимо от ключа.

В этом контексте криптоаналитики пытались восстановить структуру плохо описанных S-блоков. Первая такая попытка была предпринята в конце 1970-х, вскоре после публикации DES: Хеллман и др. выявили некоторые закономерности в S-блоках этого блочного шифра \cite{HMS76}. Совсем недавно Бирюков и др. разработали новые инструменты для этой цели. Например, статистический анализ разностных и линейных свойств позволил им показать, что S-блок Skipjack обладает большей устойчивостью к линейным атакам \cite{Mat94}, чем ожидалось \cite{BP15}.

Более важным для рассматриваемого случая является то, что они предоставили первую декомпозицию российского S-блока \(\pi\) \cite{BPU16a, BPU16b}. Соответствующая структура работает на двух ветвях, подобно структуре Фейстеля или Мисти. Однако она гораздо более сложна, так как включает умножения в конечных полях \(GF(2^4)\) и мультиплексор. Позже Перрин и Удовенко нашли разложения этой компоненты, основанные на дискретных логарифмах \cite{PU16}. Они сильно отличаются от предыдущей декомпозиции, но остаются несколько неудовлетворительными из-за сложного «арифметического слоя», которую они используют. Их авторы пришли к следующему выводу: «Мы не смогли найти разумные объяснения для использования структуры из любого из наших разложений в качестве S-блока». На самом деле, существование этих новых структур вызвало больше вопросов, чем ответов, хотя они укрепляют идею о том, что \(\pi\) имеет сильную алгебраическую структуру, вряд ли совместимую с утверждениями о случайности разработчиков» \cite{PU16}. В конце концов, Перрин и Удовенко предположили существование «основного разложения», для которого разложения в работах \cite{BPU16a} и \cite{PU16} были бы лишь побочными эффектами.

\section*{Произведенный вклад}

Мы показываем, что интуиция в \cite{PU16} была верной и представляем то, что можно назвать "главной декомпозицией". Она заключается в том, что \(\pi\), S-блок, используемый в последних двух российских стандартах, работает следующим образом:

$$
\begin{cases}\pi(0) & =\kappa(0) \\ \pi\left(\alpha^{0+17 j}\right) & =\kappa(16-j) \\ \pi\left(\alpha^{i+17 j}\right) & =\kappa(16-i) \oplus\left(\alpha^{17}\right)^{s(j)} \text { для } i>0\end{cases}
$$

где \(\alpha\) является корнем примитивного многочлена, определяющего конечное поле \(\text{GF}(2^8)\), \(s\) — это перестановка \( \mathbb{Z}/15\mathbb{Z} \), а \(\kappa: \mathbb{F}_2^4 \to \text{GF}(2^8)\) — это аффинная функция, такая что любой элемент \(x \in \text{GF}(2^8)\) может быть записан как \(x = x_4 \oplus \kappa(x_\kappa) \oplus \kappa(0)\) с \(x_4 \in \text{GF}(2^4)\) и \(x_\kappa \in \mathbb{F}_2^4\). Мы также используем “$+$” и “$-$” для обозначения целочисленного сложения и вычитания, и “$\oplus$” обозначает сложение в конечном поле.

Мы обобщаем эту новую структуру, позволяя выбирать \(\kappa\) и \(s\) из соответствующих множеств и называем полученный класс перестановок TKlog. Эта новая структура позволяет легко объяснить особое свойство \(\pi\): оно отображает разбиение \(\text{GF}(2^8)\) на мультипликативные смежные классы \(\text{GF}(2^4)^*\) в разбиение \(\text{GF}(2^8)\) на аддитивные смежные классы \(\text{GF}(2^4)^*\). Более того, ограничение \(\pi\) на каждый независимый мультипликативный смежный класс всегда является одной и той же простой функцией. Таким образом, оно не только отображает одно простое разбиение \(\text{GF}(2^8)\) в другое, но и делает это очень простым способом.

Мы также доказываем, что такие перестановки всегда могут быть записаны в виде, аналогичном декомпозиции из \cite{BPU16a}, так что наша новая декомпозиция обеспечивает недостающее звено между первой декомпозицией из \cite{BPU16a} и основанной на логарифмах декомпозицией из \cite{PU16}.

С помощью аргументов пересчета показываем, что объем множества TKlog, работающего на 8 битах, и количество аффинных 8-битных перестановок сравнимы по величине, что означает, что вероятность случайной перестановки быть экземпляром TKlog пренебрежимо мала. Мы, следовательно, утверждаем, что наличие этой структуры в \(\pi\) является преднамеренным выбором её разработчиков. Используя экспериментальные аргументы, мы предлагаем простой алгоритм генерации, выходом которого типично будет \(\pi\).

Наконец, замечаем, что линейный блок Streebog является MDS-матрицей с коэффициентами в \(\text{GF}(2^8)\), где примитивный многочлен, использованный для определения представления его элементов, на самом деле совпадает с тем, что использован для определения \(\pi\) как TKlog. Таким образом, смежные классы, взаимодействующие с \(\pi\), также взаимодействуют с линейным блоком Streebog. Мы предоставляем первое обсуждение последствий новой структуры в \(\pi\) в терминах безопасности, но оставляем их использование в криптоанализе как открытый вопрос.

\section{Структура работы}

Раздел 2 напоминает необходимый материал, как с точки зрения математики, так и с точки зрения предыдущих результатов. TKlog, его связь с \(\pi\) и свойство сохранения разбиений представлены в Разделе 3. Показано, что TKlog является «недостающим звеном» между \cite{BPU16a} и \cite{PU16}, и в Разделе 4 перечислены несколько следствий этого факта. Затем, в Разделе 5, исследуются последствия того, что \(\pi\) является TKlog, для примитивов более высокого уровня. Мы также представляем новое представление линейного слоя Стрибог, которое может представлять самостоятельный интерес. Наконец, Раздел 6 завершает эту работу.
